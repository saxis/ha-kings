{"ast":null,"code":"import { of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../core/auth.service\";\nfunction DebtsComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵdomElementStart(0, \"div\")(1, \"a\", 25);\n    i0.ɵɵtext(2);\n    i0.ɵɵdomElementStart(3, \"button\", 26);\n    i0.ɵɵdomListener(\"click\", function DebtsComponent_div_11_Template_button_click_3_listener() {\n      const item_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.removeDebt(item_r3));\n    });\n    i0.ɵɵtext(4, \"DELETE\");\n    i0.ɵɵdomElementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\" \", item_r3.biller, \" || \", item_r3.due_date, \" || \", item_r3.total_amount_due, \" \");\n  }\n}\nexport class DebtsComponent {\n  constructor(http, auth) {\n    this.http = http;\n    this.auth = auth;\n    this.debtsList$ = of([]);\n    this.userId = '';\n  }\n  ngOnInit() {\n    this.auth.restore();\n    this.debtsList$ = this.auth.user$.pipe(switchMap(u => {\n      this.userId = u?.id ?? '';\n      return this.http.get('/api/debts').pipe(map(list => this.userId ? list.filter(d => d.owner === this.userId) : list));\n    }));\n  }\n  reload() {\n    this.debtsList$ = this.http.get('/api/debts').pipe(map(list => this.userId ? list.filter(d => d.owner === this.userId) : list));\n  }\n  removeDebt(debt) {\n    if (!debt.id) return;\n    this.http.delete(`/api/debts/${debt.id}`).subscribe(() => this.reload());\n  }\n  onSubmit(f) {\n    const payload = {\n      biller: f.value.biller,\n      original_financed_amount: Number(f.value.original_financed_amount || 0),\n      principal_balance: Number(f.value.principal_balance || 0),\n      due_date: f.value.due_date || null,\n      past_due_amount: Number(f.value.past_due_amount || 0),\n      total_amount_due: Number(f.value.total_amount_due || 0),\n      interest_rate: Number(f.value.interest_rate || 0),\n      payoff_amount: Number(f.value.payoff_amount || 0),\n      owner: this.userId\n    };\n    this.http.post('/api/debts', payload).subscribe(() => this.reload());\n    f.reset();\n  }\n  static {\n    this.ɵfac = function DebtsComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || DebtsComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.AuthService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DebtsComponent,\n      selectors: [[\"app-debts\"]],\n      decls: 30,\n      vars: 3,\n      consts: [[\"f\", \"ngForm\"], [1, \"container\"], [1, \"columns\"], [1, \"column\"], [1, \"panel\"], [1, \"panel-heading\"], [1, \"panel-block\"], [1, \"control\", \"has-icons-left\"], [\"type\", \"text\", \"placeholder\", \"search\", 1, \"input\", \"is-small\"], [1, \"icon\", \"is-small\", \"is-left\"], [\"aria-hidden\", \"true\", 1, \"fas\", \"fa-search\"], [4, \"ngFor\", \"ngForOf\"], [\"novalidate\", \"\", 3, \"ngSubmit\"], [1, \"field\"], [1, \"label\"], [1, \"control\", \"has-icons-left\", \"has-icons-right\"], [\"type\", \"text\", \"placeholder\", \"Biller\", \"name\", \"biller\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Original Financed Amount\", \"name\", \"original_financed_amount\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Principal Balance\", \"name\", \"principal_balance\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"date\", \"placeholder\", \"Due Date\", \"name\", \"due_date\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Past Due Amount\", \"name\", \"past_due_amount\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Total Amount Due\", \"name\", \"total_amount_due\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Interest Rate\", \"name\", \"interest_rate\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Payoff Amount\", \"name\", \"payoff_amount\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [1, \"button\"], [1, \"panel-block\", \"is-active\", \"has-icons-right\", \"control\"], [1, \"button\", 3, \"click\"]],\n      template: function DebtsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵdomElementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"div\", 3)(3, \"nav\", 4)(4, \"p\", 5);\n          i0.ɵɵtext(5, \" Debts \");\n          i0.ɵɵdomElementEnd();\n          i0.ɵɵdomElementStart(6, \"div\", 6)(7, \"p\", 7);\n          i0.ɵɵdomElement(8, \"input\", 8);\n          i0.ɵɵdomElementStart(9, \"span\", 9);\n          i0.ɵɵdomElement(10, \"i\", 10);\n          i0.ɵɵdomElementEnd()()();\n          i0.ɵɵdomTemplate(11, DebtsComponent_div_11_Template, 5, 3, \"div\", 11);\n          i0.ɵɵpipe(12, \"async\");\n          i0.ɵɵdomElementEnd()();\n          i0.ɵɵdomElementStart(13, \"div\", 3)(14, \"form\", 12, 0);\n          i0.ɵɵdomListener(\"ngSubmit\", function DebtsComponent_Template_form_ngSubmit_14_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const f_r5 = i0.ɵɵreference(15);\n            return i0.ɵɵresetView(ctx.onSubmit(f_r5));\n          });\n          i0.ɵɵdomElementStart(16, \"div\", 13)(17, \"label\", 14);\n          i0.ɵɵtext(18, \"Add Debt\");\n          i0.ɵɵdomElementEnd();\n          i0.ɵɵdomElementStart(19, \"div\", 15);\n          i0.ɵɵdomElement(20, \"input\", 16)(21, \"input\", 17)(22, \"input\", 18)(23, \"input\", 19)(24, \"input\", 20)(25, \"input\", 21)(26, \"input\", 22)(27, \"input\", 23);\n          i0.ɵɵdomElementEnd()();\n          i0.ɵɵdomElementStart(28, \"button\", 24);\n          i0.ɵɵtext(29, \"Submit\");\n          i0.ɵɵdomElementEnd()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(11);\n          i0.ɵɵdomProperty(\"ngForOf\", i0.ɵɵpipeBind1(12, 1, ctx.debtsList$));\n        }\n      },\n      styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["of","map","switchMap","i0","ɵɵdomElementStart","ɵɵtext","ɵɵdomListener","DebtsComponent_div_11_Template_button_click_3_listener","item_r3","ɵɵrestoreView","_r2","$implicit","ctx_r3","ɵɵnextContext","ɵɵresetView","removeDebt","ɵɵdomElementEnd","ɵɵadvance","ɵɵtextInterpolate3","biller","due_date","total_amount_due","DebtsComponent","constructor","http","auth","debtsList$","userId","ngOnInit","restore","user$","pipe","u","id","get","list","filter","d","owner","reload","debt","delete","subscribe","onSubmit","f","payload","value","original_financed_amount","Number","principal_balance","past_due_amount","interest_rate","payoff_amount","post","reset","ɵɵdirectiveInject","i1","HttpClient","i2","AuthService","selectors","decls","vars","consts","template","DebtsComponent_Template","rf","ctx","ɵɵdomElement","ɵɵdomTemplate","DebtsComponent_div_11_Template","DebtsComponent_Template_form_ngSubmit_14_listener","_r1","f_r5","ɵɵreference","ɵɵdomProperty","ɵɵpipeBind1"],"sources":["/Users/saxis/dev/angular_projects/ha-kings/src/app/debts/debts.component.ts","/Users/saxis/dev/angular_projects/ha-kings/src/app/debts/debts.component.html"],"sourcesContent":["// src/app/debts/debts.component.ts\nimport { Component, OnInit } from '@angular/core';\nimport { NgForm } from '@angular/forms';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { AuthService, User } from '../core/auth.service';\n\nexport interface Debt {\n  id?: number;\n  biller: string;\n  original_financed_amount?: number;\n  principal_balance: number;\n  due_date?: string;          // ISO yyyy-mm-dd\n  past_due_amount?: number;\n  total_amount_due?: number;\n  interest_rate?: number;\n  payoff_amount?: number;\n  owner: string;              // user id\n}\n\n@Component({\n  selector: 'app-debts',\n  templateUrl: './debts.component.html',\n  styleUrls: ['./debts.component.sass']\n})\nexport class DebtsComponent implements OnInit {\n  debtsList$: Observable<Debt[]> = of([]);\n  userId = '';\n\n  constructor(private http: HttpClient, private auth: AuthService) { }\n\n  ngOnInit(): void {\n    this.auth.restore();\n    this.debtsList$ = this.auth.user$.pipe(\n      switchMap((u: User | null) => {\n        this.userId = u?.id ?? '';\n        return this.http.get<Debt[]>('/api/debts').pipe(\n          map(list => this.userId ? list.filter(d => d.owner === this.userId) : list)\n        );\n      })\n    );\n  }\n\n  private reload(): void {\n    this.debtsList$ = this.http.get<Debt[]>('/api/debts').pipe(\n      map(list => this.userId ? list.filter(d => d.owner === this.userId) : list)\n    );\n  }\n\n  removeDebt(debt: Debt): void {\n    if (!debt.id) return;\n    this.http.delete(`/api/debts/${debt.id}`).subscribe(() => this.reload());\n  }\n\n  onSubmit(f: NgForm): void {\n    const payload: Debt = {\n      biller: f.value.biller,\n      original_financed_amount: Number(f.value.original_financed_amount || 0),\n      principal_balance: Number(f.value.principal_balance || 0),\n      due_date: f.value.due_date || null,\n      past_due_amount: Number(f.value.past_due_amount || 0),\n      total_amount_due: Number(f.value.total_amount_due || 0),\n      interest_rate: Number(f.value.interest_rate || 0),\n      payoff_amount: Number(f.value.payoff_amount || 0),\n      owner: this.userId\n    };\n    this.http.post<Debt>('/api/debts', payload).subscribe(() => this.reload());\n    f.reset();\n  }\n}\n","<div class=\"container\">\n  <div class=\"columns\">\n    <div class=\"column\">\n      <nav class=\"panel\">\n        <p class=\"panel-heading\">\n          Debts\n        </p>\n        <div class=\"panel-block\">\n          <p class=\"control has-icons-left\">\n            <input class=\"input is-small\" type=\"text\" placeholder=\"search\">\n            <span class=\"icon is-small is-left\">\n              <i class=\"fas fa-search\" aria-hidden=\"true\"></i>\n            </span>\n          </p>\n        </div>\n        <div *ngFor=\"let item of debtsList$ | async\">\n          <a class=\"panel-block is-active has-icons-right control\">\n            {{item.biller}} || {{item.due_date}} || {{item.total_amount_due}}\n            <button class=\"button\" (click)=\"removeDebt(item)\">DELETE</button>\n          </a>\n        </div>\n      </nav>\n    </div>\n    <div class=\"column\">\n      <form #f=\"ngForm\" (ngSubmit)=\"onSubmit(f)\" novalidate>\n        <div class=\"field\">\n          <label class=\"label\">Add Debt</label>\n          <div class=\"control has-icons-left has-icons-right\">\n            <input class=\"input is-success\" type=\"text\"   placeholder=\"Biller\"  name=\"biller\" ngModel required  />\n            <input class=\"input is-success\" type=\"number\" placeholder=\"Original Financed Amount\"  name=\"original_financed_amount\" ngModel required >\n            <input class=\"input is-success\" type=\"number\" placeholder=\"Principal Balance\"  name=\"principal_balance\" ngModel required >\n            <input class=\"input is-success\" type=\"date\"   placeholder=\"Due Date\" name=\"due_date\"   ngModel required >\n            <input class=\"input is-success\" type=\"number\" placeholder=\"Past Due Amount\"  name=\"past_due_amount\" ngModel required >\n            <input class=\"input is-success\" type=\"number\" placeholder=\"Total Amount Due\"  name=\"total_amount_due\" ngModel required >\n            <input class=\"input is-success\" type=\"number\" placeholder=\"Interest Rate\"  name=\"interest_rate\" ngModel required >\n            <input class=\"input is-success\" type=\"number\" placeholder=\"Payoff Amount\"  name=\"payoff_amount\" ngModel required >\n          </div>\n        </div>\n        <button class=\"button\">Submit</button>\n      </form>\n    </div>\n  </div>\n</div>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}