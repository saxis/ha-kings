{"ast":null,"code":"import { of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../core/auth.service\";\nfunction AssetsComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵdomElementStart(0, \"div\")(1, \"a\", 21);\n    i0.ɵɵtext(2);\n    i0.ɵɵdomElementStart(3, \"button\", 22);\n    i0.ɵɵdomListener(\"click\", function AssetsComponent_div_11_Template_button_click_3_listener() {\n      const item_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.removeAsset(item_r3));\n    });\n    i0.ɵɵtext(4, \"DELETE\");\n    i0.ɵɵdomElementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate4(\" \", item_r3.asset_denomination, \" || \", item_r3.balance, \" || \", item_r3.purchase_time_value, \" || \", item_r3.current_value, \" \");\n  }\n}\nexport class AssetsComponent {\n  constructor(http, auth) {\n    this.http = http;\n    this.auth = auth;\n    this.assetsList$ = of([]);\n    this.userId = '';\n  }\n  ngOnInit() {\n    this.auth.restore();\n    this.assetsList$ = this.auth.user$.pipe(switchMap(u => {\n      this.userId = u?.id ?? '';\n      return this.http.get('/api/assets').pipe(map(list => this.userId ? list.filter(a => a.owner === this.userId) : list));\n    }));\n  }\n  reload() {\n    this.assetsList$ = this.http.get('/api/assets').pipe(map(list => this.userId ? list.filter(a => a.owner === this.userId) : list));\n  }\n  removeAsset(asset) {\n    if (!asset.id) return;\n    this.http.delete(`/api/assets/${asset.id}`).subscribe(() => this.reload());\n  }\n  onSubmit(f) {\n    const balance = Number(f.value.balance || 0);\n    const ppu = Number(f.value.purchase_price_per_full_unit || 0);\n    const cpu = Number(f.value.current_price_per_full_unit || 0);\n    const payload = {\n      asset_denomination: f.value.asset_denomination,\n      balance,\n      purchase_price_per_full_unit: ppu,\n      current_price_per_full_unit: cpu,\n      purchase_val: Number((balance * ppu).toFixed(2)),\n      current_val: Number((balance * cpu).toFixed(2)),\n      owner: this.userId\n    };\n    this.http.post('/api/assets', payload).subscribe(() => this.reload());\n    f.reset();\n  }\n  static {\n    this.ɵfac = function AssetsComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AssetsComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.AuthService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AssetsComponent,\n      selectors: [[\"app-assets\"]],\n      decls: 26,\n      vars: 3,\n      consts: [[\"f\", \"ngForm\"], [1, \"container\"], [1, \"columns\"], [1, \"column\"], [1, \"panel\"], [1, \"panel-heading\"], [1, \"panel-block\"], [1, \"control\", \"has-icons-left\"], [\"type\", \"text\", \"placeholder\", \"search\", 1, \"input\", \"is-small\"], [1, \"icon\", \"is-small\", \"is-left\"], [\"aria-hidden\", \"true\", 1, \"fas\", \"fa-search\"], [4, \"ngFor\", \"ngForOf\"], [\"novalidate\", \"\", 3, \"ngSubmit\"], [1, \"field\"], [1, \"label\"], [1, \"control\", \"has-icons-left\", \"has-icons-right\"], [\"type\", \"text\", \"placeholder\", \"Fiat, ETH, BTC, BCH etc\", \"name\", \"asset_denomination\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Balance\", \"name\", \"balance\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Purchase Price Per Full Unit\", \"name\", \"purchase_price_per_full_unit\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [\"type\", \"number\", \"placeholder\", \"Current Price Per Full Unit\", \"name\", \"current_price_per_full_unit\", \"ngModel\", \"\", \"required\", \"\", 1, \"input\", \"is-success\"], [1, \"button\"], [1, \"panel-block\", \"is-active\", \"has-icons-right\", \"control\"], [1, \"button\", 3, \"click\"]],\n      template: function AssetsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵdomElementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"div\", 3)(3, \"nav\", 4)(4, \"p\", 5);\n          i0.ɵɵtext(5, \" Assets \");\n          i0.ɵɵdomElementEnd();\n          i0.ɵɵdomElementStart(6, \"div\", 6)(7, \"p\", 7);\n          i0.ɵɵdomElement(8, \"input\", 8);\n          i0.ɵɵdomElementStart(9, \"span\", 9);\n          i0.ɵɵdomElement(10, \"i\", 10);\n          i0.ɵɵdomElementEnd()()();\n          i0.ɵɵdomTemplate(11, AssetsComponent_div_11_Template, 5, 4, \"div\", 11);\n          i0.ɵɵpipe(12, \"async\");\n          i0.ɵɵdomElementEnd()();\n          i0.ɵɵdomElementStart(13, \"div\", 3)(14, \"form\", 12, 0);\n          i0.ɵɵdomListener(\"ngSubmit\", function AssetsComponent_Template_form_ngSubmit_14_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const f_r5 = i0.ɵɵreference(15);\n            return i0.ɵɵresetView(ctx.onSubmit(f_r5));\n          });\n          i0.ɵɵdomElementStart(16, \"div\", 13)(17, \"label\", 14);\n          i0.ɵɵtext(18, \"Add Asset\");\n          i0.ɵɵdomElementEnd();\n          i0.ɵɵdomElementStart(19, \"div\", 15);\n          i0.ɵɵdomElement(20, \"input\", 16)(21, \"input\", 17)(22, \"input\", 18)(23, \"input\", 19);\n          i0.ɵɵdomElementEnd()();\n          i0.ɵɵdomElementStart(24, \"button\", 20);\n          i0.ɵɵtext(25, \"Submit\");\n          i0.ɵɵdomElementEnd()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(11);\n          i0.ɵɵdomProperty(\"ngForOf\", i0.ɵɵpipeBind1(12, 1, ctx.assetsList$));\n        }\n      },\n      styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["of","map","switchMap","i0","ɵɵdomElementStart","ɵɵtext","ɵɵdomListener","AssetsComponent_div_11_Template_button_click_3_listener","item_r3","ɵɵrestoreView","_r2","$implicit","ctx_r3","ɵɵnextContext","ɵɵresetView","removeAsset","ɵɵdomElementEnd","ɵɵadvance","ɵɵtextInterpolate4","asset_denomination","balance","purchase_time_value","current_value","AssetsComponent","constructor","http","auth","assetsList$","userId","ngOnInit","restore","user$","pipe","u","id","get","list","filter","a","owner","reload","asset","delete","subscribe","onSubmit","f","Number","value","ppu","purchase_price_per_full_unit","cpu","current_price_per_full_unit","payload","purchase_val","toFixed","current_val","post","reset","ɵɵdirectiveInject","i1","HttpClient","i2","AuthService","selectors","decls","vars","consts","template","AssetsComponent_Template","rf","ctx","ɵɵdomElement","ɵɵdomTemplate","AssetsComponent_div_11_Template","AssetsComponent_Template_form_ngSubmit_14_listener","_r1","f_r5","ɵɵreference","ɵɵdomProperty","ɵɵpipeBind1"],"sources":["/Users/saxis/dev/angular_projects/ha-kings/src/app/assets/assets.component.ts","/Users/saxis/dev/angular_projects/ha-kings/src/app/assets/assets.component.html"],"sourcesContent":["// src/app/assets/assets.component.ts\nimport { Component, OnInit } from '@angular/core';\nimport { NgForm } from '@angular/forms';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, of } from 'rxjs';\nimport { map, switchMap } from 'rxjs/operators';\nimport { AuthService, User } from '../core/auth.service';\n\nexport interface Asset {\n  id?: number;\n  asset_denomination: string;\n  balance: number;\n  purchase_price_per_full_unit: number;\n  current_price_per_full_unit: number;\n  purchase_val: number;\n  current_val: number;\n  owner: string; // user id\n}\n\n@Component({\n  selector: 'app-assets',\n  templateUrl: './assets.component.html',\n  styleUrls: ['./assets.component.sass']\n})\nexport class AssetsComponent implements OnInit {\n  assetsList$: Observable<Asset[]> = of([]);\n  userId = '';\n\n  constructor(private http: HttpClient, private auth: AuthService) { }\n\n  ngOnInit(): void {\n    this.auth.restore();\n    this.assetsList$ = this.auth.user$.pipe(\n      switchMap((u: User | null) => {\n        this.userId = u?.id ?? '';\n        return this.http.get<Asset[]>('/api/assets').pipe(\n          map(list => this.userId ? list.filter(a => a.owner === this.userId) : list)\n        );\n      })\n    );\n  }\n\n  private reload(): void {\n    this.assetsList$ = this.http.get<Asset[]>('/api/assets').pipe(\n      map(list => this.userId ? list.filter(a => a.owner === this.userId) : list)\n    );\n  }\n\n  removeAsset(asset: Asset): void {\n    if (!asset.id) return;\n    this.http.delete(`/api/assets/${asset.id}`).subscribe(() => this.reload());\n  }\n\n  onSubmit(f: NgForm): void {\n    const balance = Number(f.value.balance || 0);\n    const ppu = Number(f.value.purchase_price_per_full_unit || 0);\n    const cpu = Number(f.value.current_price_per_full_unit || 0);\n\n    const payload: Asset = {\n      asset_denomination: f.value.asset_denomination,\n      balance,\n      purchase_price_per_full_unit: ppu,\n      current_price_per_full_unit: cpu,\n      purchase_val: Number((balance * ppu).toFixed(2)),\n      current_val: Number((balance * cpu).toFixed(2)),\n      owner: this.userId\n    };\n\n    this.http.post<Asset>('/api/assets', payload).subscribe(() => this.reload());\n    f.reset();\n  }\n}\n","<div class=\"container\">\n  <div class=\"columns\">\n    <div class=\"column\">\n      <nav class=\"panel\">\n        <p class=\"panel-heading\">\n          Assets\n        </p>\n        <div class=\"panel-block\">\n          <p class=\"control has-icons-left\">\n            <input class=\"input is-small\" type=\"text\" placeholder=\"search\">\n            <span class=\"icon is-small is-left\">\n              <i class=\"fas fa-search\" aria-hidden=\"true\"></i>\n            </span>\n          </p>\n        </div>\n        <div *ngFor=\"let item of assetsList$ | async\">\n          <a class=\"panel-block is-active has-icons-right control\">\n            {{item.asset_denomination}} || {{item.balance}} || {{item.purchase_time_value}} || {{item.current_value}}\n            <button class=\"button\" (click)=\"removeAsset(item)\">DELETE</button>\n          </a>\n        </div>\n      </nav>\n    </div>\n    <div class=\"column\">\n      <form #f=\"ngForm\" (ngSubmit)=\"onSubmit(f)\" novalidate>\n        <div class=\"field\">\n          <label class=\"label\">Add Asset</label>\n          <div class=\"control has-icons-left has-icons-right\">\n            <input class=\"input is-success\" type=\"text\"   placeholder=\"Fiat, ETH, BTC, BCH etc\"  name=\"asset_denomination\" ngModel required  />\n            <input class=\"input is-success\" type=\"number\" placeholder=\"Balance\"  name=\"balance\" ngModel required >\n            <input class=\"input is-success\" type=\"number\" placeholder=\"Purchase Price Per Full Unit\"  name=\"purchase_price_per_full_unit\" ngModel required >\n            <input class=\"input is-success\" type=\"number\"   placeholder=\"Current Price Per Full Unit\" name=\"current_price_per_full_unit\"   ngModel required >\n          </div>\n        </div>\n        <button class=\"button\">Submit</button>\n      </form>\n    </div>\n  </div>\n</div>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}